@{
    ViewBag.Title = "Create user";
}

<h2>Create user</h2>

<form data-bind="submit: save">
    <div>
        <label for="firstName">First name:</label>
        <input id="firstName" type="text" data-bind="value:FirstName" />
    </div>
    <div>
        <label for="lastName">Last name:</label>
        <input id="lastName" type="text" data-bind="value:LastName" />
    </div>
    <div>
        <label for="userName">Username:</label>
        <input id="userName" type="text" data-bind="value:UserName" />
    </div>
    <div>
        <label for="password">Password:</label>
        <input id="password" type="password" data-bind="value:Password" />
    </div>
    <div>
        <button type="submit">Save</button>
    </div>
</form>
@section scripts
{
    <script type="text/javascript">
        var contact = {
            FirstName: new ko.observable(''),
            LastName: new ko.observable(''),
            UserName: new ko.observable(''),
            Password: new ko.observable(''),
            save: function () {
                $.ajax({
                    url: '@Url.RouteUrl("DefaultApi", new { httproute = "", controller = "UsersApi", action = "Create" })',
                    type: "POST",
                    data: ko.toJSON(this),
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        if (!data.error) {
                            window.location = '@Url.Action("Index", "Users")';
                        }
                    }
                });
            }
        };

        ko.applyBindings(contact);
    </script>
}